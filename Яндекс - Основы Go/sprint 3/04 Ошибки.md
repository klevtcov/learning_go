## Ошибки

В этой теме вы познакомитесь с типом error и научитесь:

* обрабатывать ошибки;
* определять свои типы ошибок и генерировать ошибки при возникновении аварийных ситуаций;
* «упаковывать» ошибки;
* создавать panic ошибки и восстанавливать работу программы.

При выполнении любой программы могут возникать ошибки. В одних случаях — из-за неверных входных данных или отсутствия доступа к системным ресурсам. В других — из-за плохо написанного кода, способствующего аварийным ситуациям и прекращению работы программы.

Рассмотрим на примере. Предположим, программа запрашивает у пользователя два числа и делит одно на другое. Очевидно, нужно проверить, не равен ли делитель нулю. Если такая проверка есть и пользователь вводит ноль, достаточно попросить его ввести другое число. Если проверки нет, работа программы завершится аварийной ситуацией.

Ни один язык программирования не гарантирует, что ошибок не возникнет, поэтому в любом языке найдутся инструменты для их обработки. Например, один из подходов — использование механизма исключений. Можно перехватывать ошибки в любом месте программы и решать, что делать с ними дальше.

***В Go подход к обработке ошибок отличается. Программа получает ошибку в момент возникновения и должна сразу её обработать. Это требует дополнительного кода, но уменьшает количество аварийных ситуаций.***


### Тип error

Ранее мы уже упоминали тип error вскользь. Действительно, конструкция if err != nil {} является чуть ли не визитной карточкой языка и встречается в каждой программе на Go. 

Тип error — это интерфейсный тип:

```
type error interface {
    Error() string //  Этот метод должен возвращать текст ошибки. 
}
```

Благодаря тому, что функции могут возвращать несколько значений, ошибки легко попадают в их ряды. Использование error в последнем возвращаемом значении функции — очень распространённый в Go паттерн. Если возвращаемое значение ошибки равно nil, то функция завершилась корректно. В противном случае остальные значения функции использовать нельзя и нужно обработать ошибку.

Рассмотрим пример:
```
if data, err := os.ReadFile(`nothing.txt`); err != nil {
    // будет вызван метод 'Error() string', который преобразует ошибку в строку
    fmt.Println(err)
} else {
    fmt.Println(string(data))
} 
```

Обычно в Go используется паттерн «ранний выход», поэтому код выше лучше использовать так: 
```
func ReadTextFile() (string,error) {
    if data, err := os.ReadFile(`nothing.txt`); err != nil {
        // будет вызван метод 'Error() string', который преобразует ошибку в строку
        fmt.Println(err)
        return err
    }   
    fmt.Println(string(data))
    return string(data), nil 
    
} 
```